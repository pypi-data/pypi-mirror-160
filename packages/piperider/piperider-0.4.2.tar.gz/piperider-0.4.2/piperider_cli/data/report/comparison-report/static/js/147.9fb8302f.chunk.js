"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[147],{1147:function(e,n,t){t.r(n),t.d(n,{default:function(){return T}});var i=t(841),r=t(3777),s=t(623),a=t(6629),l=t(1382),c=t(2954),d=t(5847),o=t(7313),u=t(8511),x=t(2207);var h=t(6417);function j(e){var n=e.data,t=(0,o.useRef)(null),r=(0,o.useRef)(null);return function(e){var n=e.target,t=e.data,i=e.dimensions;(0,o.useEffect)((function(){if(n&&i&&t){var e=x.Ys(n.current),r=x.tiA().domain(t.map((function(e){return e.label}))).range([0,i.width]).padding(.05),s=x.LLu(r).tickFormat((function(e,n){var t=r.domain().length-1;return 0===n||n===t/2||n===t?e:null}));e.select(".x-axis").style("transform","translateY(".concat(i.height,"px)")).call(s);var a=x.BYU().domain([0,x.Fp7(t,(function(e){return e.value}))]).range([i.height,0]),l=x.y4O(a);e.select(".y-axis").call(l),e.selectAll(".bar").data(t).join("rect").attr("class","bar").attr("x",(function(e){return r(e.label)})).attr("y",(function(e){return a(e.value)})).attr("width",r.bandwidth()).attr("height",(function(e){return i.height-a(e.value)})).style("fill","var(--chakra-colors-blue-300)");var d=(0,c.vy)({target:".chart"});return e.selectAll(".overlay-bars").data(t).join("rect").attr("class","overlay-bars").attr("x",(function(e){return r(e.label)})).attr("y",(function(){return 0})).attr("width",r.bandwidth()).attr("height",(function(){return i.height})).style("opacity",0).on("mouseover",(function(e,n){var t=n,i=t.label,r=t.value,s=t.total;d.html("\n          <div>\n            <p>Label: ".concat(i,"</p>\n            <p>Count: ").concat((0,c.uf)(r),"</p>\n            <p>Percentage: ").concat(Number(r/s*100).toFixed(3),"%</p>\n          </div>\n        ")).transition().duration(500).style("visibility","visible"),x.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(e){d.style("top","".concat(e.pageY-10,"px")).style("left","".concat(e.pageX+10,"px"))})).on("mouseout",(function(){d.html("").transition().duration(500).style("visibility","hidden"),x.Ys(this).style("opacity",0)})),function(){e.select("svg").remove()}}}),[n,i,t])}({target:t,data:n,dimensions:(0,u.y)(r)}),(0,h.jsx)(i.kC,{className:"chart",width:"100%",ref:r,children:(0,h.jsxs)("svg",{width:"100%",overflow:"visible",ref:t,children:[(0,h.jsx)("g",{className:"x-axis"}),(0,h.jsx)("g",{className:"y-axis"})]})})}var m=t(3108),f=t(4033),p=t(3837),v=function(e){var n=e.column,t=(0,c.gQ)(n),r=t.mismatch,s=t.mismatchOfTotal,a=t.missing,l=t.missingOfTotal,d=t.valid,o=t.validOfTotal,u=t.totalOfTotal;return(0,h.jsxs)(i.kC,{direction:"column",gap:3,children:[(0,h.jsxs)(i.xu,{maxWidth:"100%",children:[(0,h.jsxs)(i.kC,{children:[(0,h.jsx)(i.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,title:n.name,noOfLines:1,children:n.name}),(0,h.jsx)(m.u,{label:n.description||"",placement:"right-end",children:(0,h.jsx)(p.hQ,{m:"auto 0"})})]}),"","(",(0,h.jsx)(i.EK,{children:n.schema_type}),")"]}),(0,h.jsxs)(i.kC,{direction:"column",mt:3,children:[(0,h.jsx)(f.$,{name:"Total",base:(0,c.uf)(n.total),input:(0,c.Zn)(u)}),(0,h.jsx)(f.$,{name:"Valid",base:(0,c.uf)(d),input:(0,c.Zn)(o)}),(0,h.jsx)(f.$,{name:"Mismatched",base:(0,c.uf)(r),input:(0,c.Zn)(s)}),(0,h.jsx)(f.$,{name:"Missing",base:(0,c.uf)(a),input:(0,c.Zn)(l)}),(0,h.jsx)(f.$,{name:"Distinct",base:(0,c.uf)(n.distinct)})]}),"string"===n.type&&(0,h.jsx)(i.kC,{direction:"column",children:(0,h.jsx)(f.$,{name:"Most common",base:(0,c.jg)(n),baseWidth:"200px"})}),"numeric"===n.type&&(0,h.jsxs)(i.kC,{direction:"column",children:[(0,h.jsx)(f.$,{name:"Min",base:(0,c.uf)(n.min)}),(0,h.jsx)(f.$,{name:"Max",base:(0,c.uf)(n.max)}),(0,h.jsx)(f.$,{name:"Avg",base:(0,c.uf)(n.avg)})]}),"datetime"===n.type&&(0,h.jsxs)(i.kC,{direction:"column",children:[(0,h.jsx)(f.$,{name:"Min",base:n.min}),(0,h.jsx)(f.$,{name:"Max",base:n.max})]})]})};function g(e){var n=e.data;return(0,h.jsx)(i.kC,{direction:"column",gap:4,children:Object.keys(n).map((function(e){var t=n[e],r=t.distribution;return(0,h.jsxs)(i.kC,{direction:"column",px:4,children:[(0,h.jsxs)(i.rj,{my:4,templateColumns:"minmax(270px, 1fr) 1fr",gap:12,children:[(0,h.jsx)(v,{column:t}),(0,h.jsx)(i.kC,{mt:8,justifyContent:"center",alignItems:"center",children:r?(0,h.jsx)(j,{data:r.labels.map((function(e,n){return{label:e,value:r.counts[n],total:t.total}}))}):(0,h.jsx)(i.xv,{children:"No data available"})})]}),(0,h.jsx)(i.iz,{my:4})]},e)}))})}var b=t(9596);function y(e){var n=e.assertionData,t=e.type,r=void 0===t?"piperider":t,s=null===n||void 0===n?void 0:n.tests,a=null===n||void 0===n?void 0:n.columns;return!s||0===s.length&&0===Object.keys(a).length?(0,h.jsx)(i.kC,{direction:"column",children:(0,h.jsx)(i.xv,{textAlign:"center",children:"No tests available"})}):(0,h.jsx)(i.kC,{direction:"column",gap:4,children:(0,h.jsx)(b.xJ,{children:(0,h.jsxs)(b.iA,{variant:"simple",children:[(0,h.jsx)(b.hr,{children:(0,h.jsxs)(b.Tr,{children:[(0,h.jsx)(b.Th,{children:"Level"}),(0,h.jsx)(b.Th,{children:"Column"}),(0,h.jsx)(b.Th,{children:"Assertion"}),(0,h.jsx)(b.Th,{children:"Status"}),"piperider"===r&&(0,h.jsx)(b.Th,{children:"Expected"}),"piperider"===r&&(0,h.jsx)(b.Th,{children:"Actual"})]})}),(0,h.jsxs)(b.p3,{children:[s.map((function(e){var n="failed"===e.status;return(0,h.jsxs)(b.Tr,{children:[(0,h.jsx)(b.Td,{children:"Table"}),(0,h.jsx)(b.Td,{children:"-"}),(0,h.jsx)(b.Td,{children:e.name}),(0,h.jsx)(b.Td,{children:n?(0,h.jsx)(i.xv,{as:"span",role:"img",children:"\u274c"}):(0,h.jsx)(i.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,h.jsx)(b.Td,{children:(0,c.aH)(e.expected)}),"piperider"===r&&(0,h.jsx)(b.Td,{color:n?"red.500":"inherit",children:(0,c.aH)(e.actual)})]},e.name)})),Object.keys(a).map((function(e){return a[e].map((function(n){var t="failed"===n.status;return(0,h.jsxs)(b.Tr,{children:[(0,h.jsx)(b.Td,{children:"Column"}),(0,h.jsx)(b.Td,{children:e}),(0,h.jsx)(b.Td,{children:n.name}),(0,h.jsx)(b.Td,{children:t?(0,h.jsx)(i.xv,{as:"span",role:"img",children:"\u274c"}):(0,h.jsx)(i.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,h.jsx)(b.Td,{children:(0,c.aH)(n.expected)}),"piperider"===r&&(0,h.jsx)(b.Td,{color:t?"red.500":"inherit",children:(0,c.aH)(n.actual)})]},n.name)}))}))]})]})})})}function C(e){var n=e.table,t=e.overview;return(0,h.jsxs)(i.kC,{direction:"column",gap:4,mb:8,children:[(0,h.jsx)(i.X6,{size:"lg",children:"Overview"}),(0,h.jsxs)(i.xv,{children:["Table:"," ",(0,h.jsx)(i.xv,{as:"span",fontWeight:700,children:n.name})]}),(0,h.jsxs)(i.xv,{children:["Rows:"," ",(0,h.jsx)(i.xv,{as:"span",fontWeight:700,children:(0,c.uf)(n.row_count)})]}),(0,h.jsxs)(i.xv,{children:["Columns:"," ",(0,h.jsx)(i.xv,{as:"span",fontWeight:700,children:(0,c.uf)(n.col_count)})]}),(0,h.jsxs)(i.xv,{children:["Test Status:"," ",(0,h.jsx)(i.xv,{as:"span",fontWeight:700,children:t.passed})," ","Passed,"," ",(0,h.jsx)(i.xv,{as:"span",fontWeight:700,color:t.failed>0?"red.500":"inherit",children:t.failed})," ","Failed"]})]})}function T(e){var n=e.data,t=e.name,o=n.datasource,u=n.tables[t];if((0,d.j)(t),!n)return(0,h.jsx)(l.o,{children:(0,h.jsx)(i.kC,{justifyContent:"center",alignItems:"center",minHeight:"100vh",children:"No profile data found."})});var x=(0,c.c6)(u.piperider_assertion_result);return(0,h.jsx)(l.o,{children:(0,h.jsxs)(i.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,h.jsx)(i.kC,{mx:"10%",mt:4,children:(0,h.jsxs)(r.aG,{fontSize:"lg",children:[(0,h.jsx)(r.gN,{children:(0,h.jsx)(a.rU,{href:"/",children:(0,h.jsx)(r.At,{href:"/",children:o.name})})}),(0,h.jsx)(r.gN,{isCurrentPage:!0,children:(0,h.jsx)(r.At,{href:"#",children:u.name})})]})}),(0,h.jsxs)(i.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",children:[(0,h.jsx)(C,{table:u,overview:x}),(0,h.jsxs)(s.mQ,{isLazy:!0,children:[(0,h.jsxs)(s.td,{children:[(0,h.jsx)(s.OK,{children:"Profiling"}),(0,h.jsx)(s.OK,{children:"Tests"}),u.dbt_assertion_result&&(0,h.jsx)(s.OK,{children:"dbt Tests"})]}),(0,h.jsxs)(s.nP,{children:[(0,h.jsx)(s.x4,{children:(0,h.jsx)(g,{data:u.columns})}),(0,h.jsx)(s.x4,{children:(0,h.jsx)(y,{assertionData:u.piperider_assertion_result})}),u.piperider_assertion_result&&(0,h.jsx)(s.x4,{children:(0,h.jsx)(y,{type:"dbt",assertionData:u.dbt_assertion_result})})]})]})]})]})})}},4033:function(e,n,t){t.d(n,{$:function(){return s}});var i=t(841),r=t(6417);function s(e){var n=e.name,t=e.base,s=e.input,a=void 0===s?null:s,l=e.baseWidth,c=void 0===l?"100px":l,d=e.inputWidth,o=void 0===d?"100px":d;return(0,r.jsxs)(i.kC,{justifyContent:"space-between",children:[(0,r.jsx)(i.xv,{fontWeight:700,children:n}),(0,r.jsxs)(i.kC,{gap:{lg:5,md:1},children:[(0,r.jsx)(i.xv,{textAlign:"right",width:c,noOfLines:1,children:t}),a&&(0,r.jsx)(i.xv,{textAlign:"right",width:o,children:a})]})]})}},8511:function(e,n,t){t.d(n,{y:function(){return s}});var i=t(885),r=t(7313);function s(e){var n=(0,r.useState)(null),t=(0,i.Z)(n,2),s=t[0],a=t[1];return(0,r.useEffect)((function(){if(e&&e.current){var n=e.current,t=new ResizeObserver((function(e){e.forEach((function(e){a(e.contentRect)}))}));return t.observe(n),function(){t.unobserve(n)}}}),[e]),s}}}]);