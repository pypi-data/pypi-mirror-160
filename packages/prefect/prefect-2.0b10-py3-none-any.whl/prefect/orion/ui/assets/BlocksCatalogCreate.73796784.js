import{aa as j,ab as m,u as d,ac as x,d as D,a6 as f,c as l,e as s,a as v,w as y,g as h,b as I,a7 as P,ad as R,r as O,o as S,j as U,ae as V,af as W,ag as $,ah as q,a2 as F,W as _,q as H}from"./index.26198e4d.js";import{u as z}from"./useRouteParam.82034911.js";const g=()=>{};function T(...[k,t,c={}]){const e=j(m(d(g)));return x(t,(n,i)=>{if(n===null&&i===void 0)return;if(n===null){e.isSubscribed()&&e.unsubscribe(),Object.assign(e,m(d(g)));return}const p=m(d(k,t,c));Object.assign(e,p)},{immediate:!0}),e}const J=D({__name:"BlocksCatalogCreate",setup(k){const t=I(),c=f({}),e=f(""),n=z("blockTypeName"),i=l(()=>n.value?[n.value]:null),p=T(P.getBlockTypeByName,i),o=l(()=>p.response),B=l(()=>o.value?[{blockSchemas:{blockTypeId:{any_:[o.value.id]}}}]:null),w=T(R.getBlockSchemas,B),u=l(()=>{var a;return(a=w.response)==null?void 0:a[0]});function A(){!u.value||!o.value||F.createBlockDocument({name:e.value,data:c.value,blockSchemaId:u.value.id,blockTypeId:o.value.id}).then(({id:a})=>{_("Block created successfully","success"),t.push(H.block(a))}).catch(a=>{_("Failed to create block","error"),console.error(a)})}function C(){t.back()}return(a,r)=>{const N=O("p-layout-default");return s(o)?(S(),v(N,{key:0,class:"blocks-catalog-create"},{header:y(()=>[U(s(V),{"block-type":s(o)},null,8,["block-type"])]),default:y(()=>[s(u)?(S(),v(s(W),$({key:0,data:c.value,"onUpdate:data":r[0]||(r[0]=b=>c.value=b),name:e.value,"onUpdate:name":r[1]||(r[1]=b=>e.value=b),"block-schema":s(u)},q({submit:A,cancel:C})),null,16,["data","name","block-schema"])):h("",!0)]),_:1})):h("",!0)}}});export{J as default};
