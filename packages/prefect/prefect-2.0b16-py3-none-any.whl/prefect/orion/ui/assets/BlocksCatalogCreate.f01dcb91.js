import{ag as R,ah as j,a as T,ac as S,ai as D,d as I,u as P,c as b,r as U,e as o,o as k,b as f,w as v,i as V,aj as $,ak as N,al as O,am as z,an as F,f as y,af as H,ao as Q,ab as W,Q as _,p as q}from"./index.eda14aed.js";import{u as E}from"./useRouteParam.0a066653.js";const G=()=>{};function h(){const t=w(T(G));return t.executed=S(!1),t}function w(t){return D(t)}function g(...[t,n,u={}]){const e=R(h());return j(n,(r,d)=>{var a,l;if(r===null&&d===void 0)return;if(e.isSubscribed()&&e.unsubscribe(),r===null){Object.assign(e,h());return}const c=w(T(t,n,u));(l=(a=c.response).value)!=null||(a.value=e.response),c.executed.value=c.executed.value||e.executed,Object.assign(e,c)},{immediate:!0}),e}const L=I({__name:"BlocksCatalogCreate",setup(t){const n=P(),u=S({}),e=S(""),r=E("blockTypeSlug"),d=b(()=>r.value?[r.value]:null),c=g(H.getBlockTypeBySlug,d),a=b(()=>c.response),l=b(()=>a.value?[{blockSchemas:{blockTypeId:{any_:[a.value.id]}}}]:null),B=g(Q.getBlockSchemas,l),i=b(()=>{var s;return(s=B.response)==null?void 0:s[0]});function x(){!i.value||!a.value||W.createBlockDocument({name:e.value,data:u.value,blockSchemaId:i.value.id,blockTypeId:a.value.id}).then(({id:s})=>{_("Block created successfully","success"),n.push(q.block(s))}).catch(s=>{_("Failed to create block","error"),console.error(s)})}function A(){n.back()}return(s,p)=>{const C=U("p-layout-default");return o(a)?(k(),f(C,{key:0,class:"blocks-catalog-create"},{header:v(()=>[V(o($),{"block-type":o(a)},null,8,["block-type"])]),default:v(()=>[o(a)?(k(),f(o(N),{key:0,"block-type":o(a)},{default:v(()=>[o(i)?(k(),f(o(O),z({key:0,data:u.value,"onUpdate:data":p[0]||(p[0]=m=>u.value=m),name:e.value,"onUpdate:name":p[1]||(p[1]=m=>e.value=m),"block-schema":o(i)},F({submit:x,cancel:A})),null,16,["data","name","block-schema"])):y("",!0)]),_:1},8,["block-type"])):y("",!0)]),_:1})):y("",!0)}}});export{L as default};
