import{ab as N,ac as R,a as g,a7 as S,ad as j,d as D,u as I,c as b,r as P,e as t,o as k,b as f,w as v,i as V,ae as $,af as O,ag as U,ah as W,ai as F,f as y,aa as G,aj as H,a6 as X,W as _,p as q}from"./index.206f4421.js";import{u as z}from"./useRouteParam.6e3fcefb.js";const E=()=>{};function h(){const o=w(g(E));return o.executed=S(!1),o}function w(o){return j(o)}function T(...[o,n,u={}]){const e=N(h());return R(n,(r,m)=>{var a,l;if(r===null&&m===void 0)return;if(e.isSubscribed()&&e.unsubscribe(),r===null){Object.assign(e,h());return}const c=w(g(o,n,u));(l=(a=c.response).value)!=null||(a.value=e.response),c.executed.value=c.executed.value||e.executed,Object.assign(e,c)},{immediate:!0}),e}const L=D({__name:"BlocksCatalogCreate",setup(o){const n=I(),u=S({}),e=S(""),r=z("blockTypeName"),m=b(()=>r.value?[r.value]:null),c=T(G.getBlockTypeByName,m),a=b(()=>c.response),l=b(()=>a.value?[{blockSchemas:{blockTypeId:{any_:[a.value.id]}}}]:null),B=T(H.getBlockSchemas,l),i=b(()=>{var s;return(s=B.response)==null?void 0:s[0]});function x(){!i.value||!a.value||X.createBlockDocument({name:e.value,data:u.value,blockSchemaId:i.value.id,blockTypeId:a.value.id}).then(({id:s})=>{_("Block created successfully","success"),n.push(q.block(s))}).catch(s=>{_("Failed to create block","error"),console.error(s)})}function A(){n.back()}return(s,p)=>{const C=P("p-layout-default");return t(a)?(k(),f(C,{key:0,class:"blocks-catalog-create"},{header:v(()=>[V(t($),{"block-type":t(a)},null,8,["block-type"])]),default:v(()=>[t(a)?(k(),f(t(O),{key:0,"block-type":t(a)},{default:v(()=>[t(i)?(k(),f(t(U),W({key:0,data:u.value,"onUpdate:data":p[0]||(p[0]=d=>u.value=d),name:e.value,"onUpdate:name":p[1]||(p[1]=d=>e.value=d),"block-schema":t(i)},F({submit:x,cancel:A})),null,16,["data","name","block-schema"])):y("",!0)]),_:1},8,["block-type"])):y("",!0)]),_:1})):y("",!0)}}});export{L as default};
