"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[16],{3016:function(n,e,i){i.r(e),i.d(e,{default:function(){return O}});var t=i(8735),r=i(6837),s=i(4385),a=i(8625),l=i(3765),d=i(2483),o=i(2791),u=i(8453),c=i(8113),x=i(7735),h=i(9842);var v=i(184);function p(n){var e=n.data,i=(0,o.useRef)(null),r=(0,o.useRef)(null);return function(n){var e=n.target,i=n.data,t=n.dimensions;(0,o.useEffect)((function(){if(e&&t&&i){var n=c.Ys(e.current),r=c.tiA().domain(i.map((function(n){return n.label}))).range([0,t.width]).padding(.05),s=c.LLu(r).tickFormat((function(n,e){var i=r.domain().length-1;return 0===e||e===i/2||e===i?n:null}));n.select(".x-axis").style("transform","translateY(".concat(t.height,"px)")).call(s);var a=c.BYU().domain([0,c.Fp7(i,(function(n){return n.value}))]).range([t.height,0]),l=c.y4O(a);n.select(".y-axis").call(l),n.selectAll(".bar").data(i).join("rect").attr("class","bar").attr("x",(function(n){return r(n.label)})).attr("y",(function(n){return a(n.value)})).attr("width",r.bandwidth()).attr("height",(function(n){return t.height-a(n.value)})).style("fill","var(--chakra-colors-blue-300)");var d=(0,h.v)({target:".chart"});return n.selectAll(".overlay-bars").data(i).join("rect").attr("class","overlay-bars").attr("x",(function(n){return r(n.label)})).attr("y",(function(){return 0})).attr("width",r.bandwidth()).attr("height",(function(){return t.height})).style("opacity",0).on("mouseover",(function(n,e){var i=e,t=i.label,r=i.value,s=i.total;d.html("\n          <div>\n            <p>Label: ".concat(t,"</p>\n            <p>Count: ").concat((0,x.uf)(r),"</p>\n            <p>Percentage: ").concat(Number(r/s*100).toFixed(3),"%</p>\n          </div>\n        ")).transition().duration(500).style("visibility","visible"),c.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(n){d.style("top","".concat(n.pageY-10,"px")).style("left","".concat(n.pageX+10,"px"))})).on("mouseout",(function(){d.html("").transition().duration(500).style("visibility","hidden"),c.Ys(this).style("opacity",0)})),function(){n.select("svg").remove()}}}),[e,t,i])}({target:i,data:e,dimensions:(0,u.y)(r)}),(0,v.jsx)(t.kC,{className:"chart",width:"100%",ref:r,children:(0,v.jsxs)("svg",{width:"100%",overflow:"visible",ref:i,children:[(0,v.jsx)("g",{className:"x-axis"}),(0,v.jsx)("g",{className:"y-axis"})]})})}var m=i(6108),f=i(5272),j=i(8662),g=i(709),b=i(8853),y=function(n){var e=n.column;return(0,v.jsxs)(t.kC,{direction:"column",gap:3,children:[(0,v.jsxs)(t.xu,{maxWidth:"100%",children:[(0,v.jsxs)(t.kC,{children:[(0,v.jsx)(t.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,title:e.name,noOfLines:1,children:e.name}),(0,v.jsx)(b.l,{label:e.description||"",prefix:" - via ",placement:"right-end",children:(0,v.jsx)(f.hQ,{m:"auto 0"})})]}),"","(",(0,v.jsx)(t.EK,{children:e.schema_type}),")"]}),(0,v.jsx)(t.kC,{direction:"column",mt:3,children:(0,v.jsx)(g.H,{baseColumn:e})}),"string"===e.type&&e.distribution&&(0,v.jsx)(t.kC,{direction:"column",children:(0,v.jsx)(m.$,{name:"Most common",base:(0,x.jg)(e),baseWidth:"200px"})}),"numeric"===e.type&&(0,v.jsx)(j.D,{baseColumn:e}),"datetime"===e.type&&(0,v.jsxs)(t.kC,{direction:"column",children:[(0,v.jsx)(m.$,{name:"Min",base:e.min}),(0,v.jsx)(m.$,{name:"Max",base:e.max})]})]})};function k(n){var e=n.data;return(0,v.jsx)(t.kC,{direction:"column",gap:4,children:Object.keys(e).map((function(n){var i=e[n],r=i.distribution;return(0,v.jsxs)(t.kC,{direction:"column",px:4,children:[(0,v.jsxs)(t.rj,{my:4,templateColumns:"minmax(270px, 1fr) 1fr",gap:12,children:[(0,v.jsx)(y,{column:i}),(0,v.jsx)(t.kC,{mt:8,justifyContent:"center",alignItems:"center",children:r?(0,v.jsx)(p,{data:r.labels.map((function(n,e){return{label:n,value:r.counts[e],total:i.total}}))}):(0,v.jsx)(t.xv,{children:"No data available"})})]}),(0,v.jsx)(t.iz,{my:4})]},n)}))})}var C=i(7005);function T(n){var e=n.assertionData,i=n.type,r=void 0===i?"piperider":i,s=null===e||void 0===e?void 0:e.tests,a=null===e||void 0===e?void 0:e.columns;return!s||0===s.length&&0===Object.keys(a).length?(0,v.jsx)(t.kC,{direction:"column",children:(0,v.jsx)(t.xv,{textAlign:"center",children:"No tests available"})}):(0,v.jsx)(t.kC,{direction:"column",gap:4,children:(0,v.jsx)(C.xJ,{children:(0,v.jsxs)(C.iA,{variant:"simple",children:[(0,v.jsx)(C.hr,{children:(0,v.jsxs)(C.Tr,{children:[(0,v.jsx)(C.Th,{children:"Level"}),(0,v.jsx)(C.Th,{children:"Column"}),(0,v.jsx)(C.Th,{children:"Assertion"}),(0,v.jsx)(C.Th,{children:"Status"}),"piperider"===r&&(0,v.jsx)(C.Th,{children:"Expected"}),"piperider"===r&&(0,v.jsx)(C.Th,{children:"Actual"})]})}),(0,v.jsxs)(C.p3,{children:[s.map((function(n){var e="failed"===n.status;return(0,v.jsxs)(C.Tr,{children:[(0,v.jsx)(C.Td,{children:"Table"}),(0,v.jsx)(C.Td,{children:"-"}),(0,v.jsx)(C.Td,{children:n.name}),(0,v.jsx)(C.Td,{children:e?(0,v.jsx)(t.xv,{as:"span",role:"img",children:"\u274c"}):(0,v.jsx)(t.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,v.jsx)(C.Td,{children:(0,x.aH)(n.expected)}),"piperider"===r&&(0,v.jsx)(C.Td,{color:e?"red.500":"inherit",children:(0,x.aH)(n.actual)})]},n.name)})),Object.keys(a).map((function(n){return a[n].map((function(e){var i="failed"===e.status;return(0,v.jsxs)(C.Tr,{children:[(0,v.jsx)(C.Td,{children:"Column"}),(0,v.jsx)(C.Td,{children:n}),(0,v.jsx)(C.Td,{children:e.name}),(0,v.jsx)(C.Td,{children:i?(0,v.jsx)(t.xv,{as:"span",role:"img",children:"\u274c"}):(0,v.jsx)(t.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,v.jsx)(C.Td,{children:(0,x.aH)(e.expected)}),"piperider"===r&&(0,v.jsx)(C.Td,{color:i?"red.500":"inherit",children:(0,x.aH)(e.actual)})]},e.name)}))}))]})]})})})}function w(n){var e=n.table,i=(0,x.YI)(e.piperider_assertion_result,e.dbt_assertion_result);return(0,v.jsxs)(t.kC,{direction:"column",gap:4,mb:8,children:[(0,v.jsx)(t.X6,{size:"lg",children:"Overview"}),(0,v.jsxs)(t.xv,{children:["Table:"," ",(0,v.jsx)(t.xv,{as:"span",fontWeight:700,children:e.name})]}),(0,v.jsxs)(t.xv,{children:["Rows:"," ",(0,v.jsx)(t.xv,{as:"span",fontWeight:700,children:(0,x.uf)(e.row_count)})]}),(0,v.jsxs)(t.xv,{children:["Columns:"," ",(0,v.jsx)(t.xv,{as:"span",fontWeight:700,children:(0,x.uf)(e.col_count)})]}),(0,v.jsxs)(t.xv,{children:["Test Status:"," ",(0,v.jsx)(t.xv,{as:"span",fontWeight:700,children:i.passed})," ","Passed,"," ",(0,v.jsx)(t.xv,{as:"span",fontWeight:700,color:i.failed>0?"red.500":"inherit",children:i.failed})," ","Failed"]})]})}function O(n){var e=n.data,i=n.name,o=e.datasource,u=e.tables[i];return(0,d.j)(i),e?(0,v.jsx)(l.o,{children:(0,v.jsxs)(t.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,v.jsx)(t.kC,{mx:"10%",mt:4,children:(0,v.jsxs)(r.aG,{fontSize:"lg",children:[(0,v.jsx)(r.gN,{children:(0,v.jsx)(a.rU,{href:"/",children:(0,v.jsx)(r.At,{href:"/","data-cy":"sr-report-breadcrumb-back",children:o.name})})}),(0,v.jsx)(r.gN,{isCurrentPage:!0,children:(0,v.jsx)(r.At,{href:"#",children:u.name})})]})}),(0,v.jsxs)(t.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",children:[(0,v.jsx)(w,{table:u}),(0,v.jsxs)(s.mQ,{isLazy:!0,children:[(0,v.jsxs)(s.td,{children:[(0,v.jsx)(s.OK,{children:"Profiling"}),(0,v.jsx)(s.OK,{"data-cy":"sr-report-tab-item",children:"Tests"}),u.dbt_assertion_result&&(0,v.jsx)(s.OK,{children:"dbt Tests"})]}),(0,v.jsxs)(s.nP,{children:[(0,v.jsx)(s.x4,{children:(0,v.jsx)(k,{data:u.columns})}),(0,v.jsx)(s.x4,{children:(0,v.jsx)(T,{assertionData:u.piperider_assertion_result})}),(null===u||void 0===u?void 0:u.dbt_assertion_result)&&(0,v.jsx)(s.x4,{children:(0,v.jsx)(T,{type:"dbt",assertionData:u.dbt_assertion_result})})]})]})]})]})}):(0,v.jsx)(l.o,{children:(0,v.jsx)(t.kC,{justifyContent:"center",alignItems:"center",minHeight:"100vh",children:"No profile data found."})})}},709:function(n,e,i){i.d(e,{H:function(){return a}});var t=i(7735),r=i(6108),s=i(184);function a(n){var e=n.baseColumn,i=n.inputColumn;if(e)var a=(0,t.gQ)(e),l=a.totalOfTotal,d=a.total,o=a.mismatch,u=a.missing,c=a.mismatchOfTotal,x=a.validOfTotal,h=a.missingOfTotal;if(i)var v=(0,t.gQ)(i),p=v.total,m=v.mismatchOfTotal,f=v.validOfTotal,j=v.missingOfTotal;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.$,{name:"Total",base:(0,t.uy)(d,t.uf),input:(0,t.uy)(i?p:l,i?t.uf:t.Zn)}),(0,s.jsx)(r.$,{name:"Valid",base:(0,t.uy)(i?x:d,i?t.Zn:t.uf),input:(0,t.uy)(i?f:x,t.Zn)}),(0,s.jsx)(r.$,{name:"Mismatched",base:(0,t.uy)(i?c:o,i?t.Zn:t.uf),input:(0,t.uy)(i?m:c,t.Zn)}),(0,s.jsx)(r.$,{name:"Missing",base:(0,t.uy)(i?h:u,i?t.Zn:t.uf),input:(0,t.uy)(i?j:h,t.Zn)}),(0,s.jsx)(r.$,{name:"Distinct",base:(0,t.uy)(null===e||void 0===e?void 0:e.distinct,t.uf),input:i&&(0,t.uy)(null===i||void 0===i?void 0:i.distinct,t.uf)})]})}},6108:function(n,e,i){i.d(e,{$:function(){return s}});var t=i(8735),r=i(184);function s(n){var e=n.name,i=n.base,s=n.input,a=void 0===s?null:s,l=n.baseWidth,d=void 0===l?"100px":l,o=n.inputWidth,u=void 0===o?"100px":o;return(0,r.jsxs)(t.kC,{justifyContent:"space-between",children:[(0,r.jsx)(t.xv,{fontWeight:700,children:e}),(0,r.jsxs)(t.kC,{gap:{lg:5,md:1},children:[(0,r.jsx)(t.xv,{textAlign:"right",width:d,noOfLines:1,children:i}),a&&(0,r.jsx)(t.xv,{textAlign:"right",width:u,children:a})]})]})}},8662:function(n,e,i){i.d(e,{D:function(){return l}});var t=i(8735),r=i(7735),s=i(6108),a=i(184);function l(n){var e=n.baseColumn,i=n.inputColumn;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.kC,{direction:"column",children:[(0,a.jsx)(s.$,{name:"Average",base:(0,r.uy)(null===e||void 0===e?void 0:e.avg,r.uf),input:i&&(0,r.uy)(null===i||void 0===i?void 0:i.avg,r.uf)}),(0,a.jsx)(s.$,{name:"Std. Deviation",base:(0,r.uy)(null===e||void 0===e?void 0:e.stddev,r.uf),input:i&&(0,r.uy)(null===i||void 0===i?void 0:i.stddev,r.uf)})]}),(0,a.jsxs)(t.kC,{direction:"column",children:[(0,a.jsx)(s.$,{name:"Min",base:(0,r.uy)(null===e||void 0===e?void 0:e.min,r.uf),input:i&&(0,r.uy)(null===i||void 0===i?void 0:i.min,r.uf)}),(0,a.jsx)(s.$,{name:"5%",base:(0,r.uy)(null===e||void 0===e?void 0:e.p5,r.uf),input:i&&(0,r.uy)(null===i||void 0===i?void 0:i.p5,r.uf)}),(0,a.jsx)(s.$,{name:"25%",base:(0,r.uy)(null===e||void 0===e?void 0:e.p25,r.uf),input:i&&(0,r.uy)(null===i||void 0===i?void 0:i.p25,r.uf)}),(0,a.jsx)(s.$,{name:"50%",base:(0,r.uy)(null===e||void 0===e?void 0:e.p50,r.uf),input:i&&(0,r.uy)(null===i||void 0===i?void 0:i.p50,r.uf)}),(0,a.jsx)(s.$,{name:"75%",base:(0,r.uy)(null===e||void 0===e?void 0:e.p75,r.uf),input:i&&(0,r.uy)(null===i||void 0===i?void 0:i.p75,r.uf)}),(0,a.jsx)(s.$,{name:"95%",base:(0,r.uy)(null===e||void 0===e?void 0:e.p95,r.uf),input:i&&(0,r.uy)(null===i||void 0===i?void 0:i.p95,r.uf)}),(0,a.jsx)(s.$,{name:"Max",base:(0,r.uy)(null===e||void 0===e?void 0:e.max,r.uf),input:i&&(0,r.uy)(null===i||void 0===i?void 0:i.max,r.uf)})]})]})}},8453:function(n,e,i){i.d(e,{y:function(){return s}});var t=i(885),r=i(2791);function s(n){var e=(0,r.useState)(null),i=(0,t.Z)(e,2),s=i[0],a=i[1];return(0,r.useEffect)((function(){if(n&&n.current){var e=n.current,i=new ResizeObserver((function(n){n.forEach((function(n){a(n.contentRect)}))}));return i.observe(e),function(){i.unobserve(e)}}}),[n]),s}},9842:function(n,e,i){i.d(e,{v:function(){return c}});var t=i(8113),r="var(--chakra-space-2)",s="var(--chakra-space-2)",a="var(--chakra-space-4)",l="var(--chakra-space-4)",d="var(--chakra-radii-md)",o="var(--chakra-colors-white)",u="var(--chakra-colors-blackAlpha-700)";function c(n){var e=n.target,i=n.style,c=void 0===i?{}:i;return t.Ys(e).append("div").style("visibility","hidden").style("position","absolute").style("z-index","9").style("padding-top",(null===c||void 0===c?void 0:c.paddingTop)||r).style("padding-bottom",(null===c||void 0===c?void 0:c.paddingBottom)||s).style("border-radius",(null===c||void 0===c?void 0:c.borderRadius)||d).style("padding-left",(null===c||void 0===c?void 0:c.paddingLeft)||a).style("padding-right",(null===c||void 0===c?void 0:c.paddingRight)||l).style("color",(null===c||void 0===c?void 0:c.color)||o).style("background-color",(null===c||void 0===c?void 0:c.backgroundColor)||u)}}}]);
//# sourceMappingURL=16.814d094d.chunk.js.map