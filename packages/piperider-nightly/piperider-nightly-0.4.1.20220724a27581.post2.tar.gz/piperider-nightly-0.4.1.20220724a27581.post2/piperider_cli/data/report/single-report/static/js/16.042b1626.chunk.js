"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[16],{3016:function(e,n,i){i.r(n),i.d(n,{default:function(){return W}});var t=i(8735),r=i(6837),a=i(4385),s=i(8625),l=i(3765),d=i(2483),o=i(2791),u=i(8453),c=i(5251),x=i(1971),h=i(9842);var v=i(184);function p(e){var n=e.data,i=(0,o.useRef)(null),r=(0,o.useRef)(null);return function(e){var n=e.target,i=e.data,t=e.dimensions;(0,o.useEffect)((function(){if(n&&t&&i){var e=c.Ys(n.current),r=c.tiA().domain(i.map((function(e){return e.label}))).range([0,t.width]).padding(.05),a=c.LLu(r).tickFormat((function(e,n){var i=r.domain().length-1;return 0===n||n===i/2||n===i?e:null}));e.select(".x-axis").style("transform","translateY(".concat(t.height,"px)")).call(a);var s=c.BYU().domain([0,c.Fp7(i,(function(e){return e.value}))]).range([t.height,0]),l=c.y4O(s);e.select(".y-axis").call(l),e.selectAll(".bar").data(i).join("rect").attr("class","bar").attr("x",(function(e){return r(e.label)})).attr("y",(function(e){return s(e.value)})).attr("width",r.bandwidth()).attr("height",(function(e){return t.height-s(e.value)})).style("fill","var(--chakra-colors-blue-300)");var d=(0,h.v)({target:".chart"});return e.selectAll(".overlay-bars").data(i).join("rect").attr("class","overlay-bars").attr("x",(function(e){return r(e.label)})).attr("y",(function(){return 0})).attr("width",r.bandwidth()).attr("height",(function(){return t.height})).style("opacity",0).on("mouseover",(function(e,n){var i=n,t=i.label,r=i.value,a=i.total;d.html("\n          <div>\n            <p>Label: ".concat(t,"</p>\n            <p>Count: ").concat((0,x.uf)(r),"</p>\n            <p>Percentage: ").concat(Number(r/a*100).toFixed(3),"%</p>\n          </div>\n        ")).transition().duration(500).style("visibility","visible"),c.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(e){d.style("top","".concat(e.pageY-10,"px")).style("left","".concat(e.pageX+10,"px"))})).on("mouseout",(function(){d.html("").transition().duration(500).style("visibility","hidden"),c.Ys(this).style("opacity",0)})),function(){e.select("svg").remove()}}}),[n,t,i])}({target:i,data:n,dimensions:(0,u.y)(r)}),(0,v.jsx)(t.kC,{className:"chart",width:"100%",ref:r,children:(0,v.jsxs)("svg",{width:"100%",overflow:"visible",ref:i,children:[(0,v.jsx)("g",{className:"x-axis"}),(0,v.jsx)("g",{className:"y-axis"})]})})}var m=i(6108),f=i(5272),j=i(8662),y=i(709),b=i(8853),g=i(6523),k=function(e){var n=e.column;return g.a$.omit({type:!0,stddev:!0}).parse(n),(0,v.jsxs)(t.kC,{direction:"column",gap:3,children:[(0,v.jsxs)(t.xu,{maxWidth:"100%",children:[(0,v.jsxs)(t.kC,{children:[(0,v.jsx)(t.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,title:n.name,noOfLines:1,children:n.name}),(0,v.jsx)(b.l,{label:n.description,prefix:" - via ",placement:"right-end",children:(0,v.jsx)(f.hQ,{m:"auto 0"})})]}),"","(",(0,v.jsx)(t.EK,{children:n.schema_type}),")"]}),(0,v.jsx)(t.kC,{direction:"column",mt:3,children:(0,v.jsx)(y.H,{baseColumn:n})}),"string"===n.type&&n.distribution&&(0,v.jsx)(t.kC,{direction:"column",children:(0,v.jsx)(m.$,{name:"Most common",base:(0,x.qW)(n),baseWidth:"200px"})}),"numeric"===n.type&&(0,v.jsx)(j.D,{baseColumn:n}),"datetime"===n.type&&(0,v.jsxs)(t.kC,{direction:"column",children:[(0,v.jsx)(m.$,{name:"Min",base:n.min}),(0,v.jsx)(m.$,{name:"Max",base:n.max})]})]})},C=i(4821);function T(e){var n=e.data;return(0,v.jsx)(t.kC,{direction:"column",gap:4,children:Object.keys(n).map((function(e){var i=n[e];g.a$.parse(i);var r=C.Sn.parse(i.distribution);return(0,v.jsxs)(t.kC,{direction:"column",px:4,children:[(0,v.jsxs)(t.rj,{my:4,templateColumns:"minmax(270px, 1fr) 1fr",gap:12,children:[(0,v.jsx)(k,{column:i}),(0,v.jsx)(t.kC,{mt:8,justifyContent:"center",alignItems:"center",children:r?(0,v.jsx)(p,{data:r.labels.map((function(e,n){return{label:e,value:r.counts[n],total:i.total}}))}):(0,v.jsx)(t.xv,{children:"No data available"})})]}),(0,v.jsx)(t.iz,{my:4})]},e)}))})}var $=i(7005),w=i(9201);function O(e){var n=e.assertionData,i=e.type,r=void 0===i?"piperider":i,a=null===n||void 0===n?void 0:n.tests,s=null===n||void 0===n?void 0:n.columns;return!a||0===a.length&&0===Object.keys(s).length?(0,v.jsx)(t.kC,{direction:"column",children:(0,v.jsx)(t.xv,{textAlign:"center",children:"No tests available"})}):(0,v.jsx)(t.kC,{direction:"column",gap:4,children:(0,v.jsx)($.xJ,{children:(0,v.jsxs)($.iA,{variant:"simple",children:[(0,v.jsx)($.hr,{children:(0,v.jsxs)($.Tr,{children:[(0,v.jsx)($.Th,{children:"Level"}),(0,v.jsx)($.Th,{children:"Column"}),(0,v.jsx)($.Th,{children:"Assertion"}),(0,v.jsx)($.Th,{children:"Status"}),"piperider"===r&&(0,v.jsx)($.Th,{children:"Expected"}),"piperider"===r&&(0,v.jsx)($.Th,{children:"Actual"})]})}),(0,v.jsxs)($.p3,{children:[a.map((function(e){C.S1.parse(e);var n="failed"===e.status;return(0,v.jsxs)($.Tr,{children:[(0,v.jsx)($.Td,{children:"Table"}),(0,v.jsx)($.Td,{children:"-"}),(0,v.jsx)($.Td,{children:e.name}),(0,v.jsx)($.Td,{children:n?(0,v.jsx)(t.xv,{as:"span",role:"img",children:"\u274c"}):(0,v.jsx)(t.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,v.jsx)($.Td,{children:(0,x.sG)(e.expected)}),"piperider"===r&&(0,v.jsx)($.Td,{color:n?"red.500":"inherit",children:(0,x.sG)(e.actual)})]},e.name)})),Object.keys(s).map((function(e){var n=s[e];return w.z.array(C.S1).parse(n),n.map((function(n){var i="failed"===n.status;return(0,v.jsxs)($.Tr,{children:[(0,v.jsx)($.Td,{children:"Column"}),(0,v.jsx)($.Td,{children:e}),(0,v.jsx)($.Td,{children:n.name}),(0,v.jsx)($.Td,{children:i?(0,v.jsx)(t.xv,{as:"span",role:"img",children:"\u274c"}):(0,v.jsx)(t.xv,{as:"span",role:"img",children:"\u2705"})}),"piperider"===r&&(0,v.jsx)($.Td,{children:(0,x.sG)(n.expected)}),"piperider"===r&&(0,v.jsx)($.Td,{color:i?"red.500":"inherit",children:(0,x.sG)(n.actual)})]},n.name)}))}))]})]})})})}var _=i(6157);function A(e){var n=e.table;g.vT.parse(n);var i=(0,_.YI)(n.piperider_assertion_result,n.dbt_assertion_result);return(0,v.jsxs)(t.kC,{direction:"column",gap:4,mb:8,children:[(0,v.jsx)(t.X6,{size:"lg",children:"Overview"}),(0,v.jsxs)(t.xv,{children:["Table:"," ",(0,v.jsx)(t.xv,{as:"span",fontWeight:700,children:n.name})]}),(0,v.jsxs)(t.xv,{children:["Rows:"," ",(0,v.jsx)(t.xv,{as:"span",fontWeight:700,children:(0,x.uf)(n.row_count)})]}),(0,v.jsxs)(t.xv,{children:["Columns:"," ",(0,v.jsx)(t.xv,{as:"span",fontWeight:700,children:(0,x.uf)(n.col_count)})]}),(0,v.jsxs)(t.xv,{children:["Test Status:"," ",(0,v.jsx)(t.xv,{as:"span",fontWeight:700,children:i.passed})," ","Passed,"," ",(0,v.jsx)(t.xv,{as:"span",fontWeight:700,color:i.failed>0?"red.500":"inherit",children:i.failed})," ","Failed"]})]})}function W(e){var n=e.data,i=e.name,o=n.datasource,u=n.tables[i];return g.vT.parse(u),C.U0.parse(o),(0,d.j)(i),n?(0,v.jsx)(l.o,{children:(0,v.jsxs)(t.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,v.jsx)(t.kC,{mx:"10%",mt:4,children:(0,v.jsxs)(r.aG,{fontSize:"lg",children:[(0,v.jsx)(r.gN,{children:(0,v.jsx)(s.rU,{href:"/",children:(0,v.jsx)(r.At,{href:"/","data-cy":"sr-report-breadcrumb-back",children:o.name})})}),(0,v.jsx)(r.gN,{isCurrentPage:!0,children:(0,v.jsx)(r.At,{href:"#",children:u.name})})]})}),(0,v.jsxs)(t.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",children:[(0,v.jsx)(A,{table:u}),(0,v.jsxs)(a.mQ,{isLazy:!0,children:[(0,v.jsxs)(a.td,{children:[(0,v.jsx)(a.OK,{children:"Profiling"}),(0,v.jsx)(a.OK,{"data-cy":"sr-report-tab-item",children:"Tests"}),u.dbt_assertion_result&&(0,v.jsx)(a.OK,{children:"dbt Tests"})]}),(0,v.jsxs)(a.nP,{children:[(0,v.jsx)(a.x4,{children:(0,v.jsx)(T,{data:u.columns})}),(0,v.jsx)(a.x4,{children:(0,v.jsx)(O,{assertionData:u.piperider_assertion_result})}),(null===u||void 0===u?void 0:u.dbt_assertion_result)&&(0,v.jsx)(a.x4,{children:(0,v.jsx)(O,{type:"dbt",assertionData:u.dbt_assertion_result})})]})]})]})]})}):(0,v.jsx)(l.o,{children:(0,v.jsx)(t.kC,{justifyContent:"center",alignItems:"center",minHeight:"100vh",children:"No profile data found."})})}},709:function(e,n,i){i.d(n,{H:function(){return d}});var t=i(6523),r=i(1971),a=i(922),s=i(6108),l=i(184);function d(e){var n=e.baseColumn,i=e.inputColumn;if(n){t.a$.parse(n);var d=(0,a.gQ)(n),o=d.totalOfTotal,u=d.total,c=d.mismatch,x=d.missing,h=d.mismatchOfTotal,v=d.validOfTotal,p=d.missingOfTotal}if(i){t.a$.parse(i);var m=(0,a.gQ)(i),f=m.total,j=m.mismatchOfTotal,y=m.validOfTotal,b=m.missingOfTotal}return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.$,{name:"Total",base:(0,r.uy)(u,r.uf),input:(0,r.uy)(i?f:o,i?r.uf:r.Zn)}),(0,l.jsx)(s.$,{name:"Valid",base:(0,r.uy)(i?v:u,i?r.Zn:r.uf),input:(0,r.uy)(i?y:v,r.Zn)}),(0,l.jsx)(s.$,{name:"Mismatched",base:(0,r.uy)(i?h:c,i?r.Zn:r.uf),input:(0,r.uy)(i?j:h,r.Zn)}),(0,l.jsx)(s.$,{name:"Missing",base:(0,r.uy)(i?p:x,i?r.Zn:r.uf),input:(0,r.uy)(i?b:p,r.Zn)}),(0,l.jsx)(s.$,{name:"Distinct",base:(0,r.uy)(null===n||void 0===n?void 0:n.distinct,r.uf),input:i&&(0,r.uy)(null===i||void 0===i?void 0:i.distinct,r.uf)})]})}},6108:function(e,n,i){i.d(n,{$:function(){return a}});var t=i(8735),r=i(184);function a(e){var n=e.name,i=e.base,a=e.input,s=void 0===a?null:a,l=e.baseWidth,d=void 0===l?"100px":l,o=e.inputWidth,u=void 0===o?"100px":o;return(0,r.jsxs)(t.kC,{justifyContent:"space-between",children:[(0,r.jsx)(t.xv,{fontWeight:700,children:n}),(0,r.jsxs)(t.kC,{gap:{lg:5,md:1},children:[(0,r.jsx)(t.xv,{textAlign:"right",width:d,noOfLines:1,children:i}),s&&(0,r.jsx)(t.xv,{textAlign:"right",width:u,children:s})]})]})}},8662:function(e,n,i){i.d(n,{D:function(){return d}});var t=i(8735),r=i(6523),a=i(1971),s=i(6108),l=i(184);function d(e){var n=e.baseColumn,i=e.inputColumn;return r.a$.parse(n),r.a$.parse(n),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(t.kC,{direction:"column",children:[(0,l.jsx)(s.$,{name:"Average",base:(0,a.uy)(null===n||void 0===n?void 0:n.avg,a.uf),input:i&&(0,a.uy)(null===i||void 0===i?void 0:i.avg,a.uf)}),(0,l.jsx)(s.$,{name:"Std. Deviation",base:(0,a.uy)(null===n||void 0===n?void 0:n.stddev,a.uf),input:i&&(0,a.uy)(null===i||void 0===i?void 0:i.stddev,a.uf)})]}),(0,l.jsxs)(t.kC,{direction:"column",children:[(0,l.jsx)(s.$,{name:"Min",base:(0,a.uy)(null===n||void 0===n?void 0:n.min,a.uf),input:i&&(0,a.uy)(null===i||void 0===i?void 0:i.min,a.uf)}),(0,l.jsx)(s.$,{name:"5%",base:(0,a.uy)(null===n||void 0===n?void 0:n.p5,a.uf),input:i&&(0,a.uy)(null===i||void 0===i?void 0:i.p5,a.uf)}),(0,l.jsx)(s.$,{name:"25%",base:(0,a.uy)(null===n||void 0===n?void 0:n.p25,a.uf),input:i&&(0,a.uy)(null===i||void 0===i?void 0:i.p25,a.uf)}),(0,l.jsx)(s.$,{name:"50%",base:(0,a.uy)(null===n||void 0===n?void 0:n.p50,a.uf),input:i&&(0,a.uy)(null===i||void 0===i?void 0:i.p50,a.uf)}),(0,l.jsx)(s.$,{name:"75%",base:(0,a.uy)(null===n||void 0===n?void 0:n.p75,a.uf),input:i&&(0,a.uy)(null===i||void 0===i?void 0:i.p75,a.uf)}),(0,l.jsx)(s.$,{name:"95%",base:(0,a.uy)(null===n||void 0===n?void 0:n.p95,a.uf),input:i&&(0,a.uy)(null===i||void 0===i?void 0:i.p95,a.uf)}),(0,l.jsx)(s.$,{name:"Max",base:(0,a.uy)(null===n||void 0===n?void 0:n.max,a.uf),input:i&&(0,a.uy)(null===i||void 0===i?void 0:i.max,a.uf)})]})]})}},8453:function(e,n,i){i.d(n,{y:function(){return a}});var t=i(885),r=i(2791);function a(e){var n=(0,r.useState)(null),i=(0,t.Z)(n,2),a=i[0],s=i[1];return(0,r.useEffect)((function(){if(e&&e.current){var n=e.current,i=new ResizeObserver((function(e){e.forEach((function(e){s(e.contentRect)}))}));return i.observe(n),function(){i.unobserve(n)}}}),[e]),a}},9842:function(e,n,i){i.d(n,{v:function(){return c}});var t=i(5251),r="var(--chakra-space-2)",a="var(--chakra-space-2)",s="var(--chakra-space-4)",l="var(--chakra-space-4)",d="var(--chakra-radii-md)",o="var(--chakra-colors-white)",u="var(--chakra-colors-blackAlpha-700)";function c(e){var n=e.target,i=e.style,c=void 0===i?{}:i;return t.Ys(n).append("div").style("visibility","hidden").style("position","absolute").style("z-index","9").style("padding-top",(null===c||void 0===c?void 0:c.paddingTop)||r).style("padding-bottom",(null===c||void 0===c?void 0:c.paddingBottom)||a).style("border-radius",(null===c||void 0===c?void 0:c.borderRadius)||d).style("padding-left",(null===c||void 0===c?void 0:c.paddingLeft)||s).style("padding-right",(null===c||void 0===c?void 0:c.paddingRight)||l).style("color",(null===c||void 0===c?void 0:c.color)||o).style("background-color",(null===c||void 0===c?void 0:c.backgroundColor)||u)}}}]);
//# sourceMappingURL=16.042b1626.chunk.js.map